function agCountryMaskLoad(a,e){a.debug&&console.log("=> CMask init: "+e),a.user.aspro&&"function"==typeof orderActions&&agCountryMaskAsproOrderFix(),$(a.js.input_selectors).each(function(){var e,t=$(this);"Y"!=t.data("maskactive")&&(a.debug&&console.log("- Apply mask for:",t,"Input value: "+t.val()),t.attr("inputmode","tel").attr("autocomplete","tel"),e=window.intlTelInputAG(t.get(0),{autoPlaceholder:"aggressive",placeholderNumberType:"MOBILE",customContainer:"ag-countrymask",customPlaceholder:function(e,t){return"0"==t.dialCode?"":a.default.country_sng.includes(t.iso2)?"+"+t.dialCode+" "+e.replace(/[0-9]/g,"_"):"+"+t.dialCode+" "},initialCountry:a.lib.country_init,preferredCountries:a.lib.country_main,onlyCountries:a.lib.country_show,localizedCountries:a.LOC,autoHideDialCode:!1,nationalMode:!1,separateDialCode:!0,utilsScript:a.script.s2}),a.user.aspro&&$(".iti.ag-countrymask input").prop("autocomplete","tel"),e.promise.then(function(){agCountryMaskBase(a,t,0,0)}),t.on("countrychange",function(){agCountryMaskBase(a,$(this),a.js.clear_on_change,1)}),t.data("maskactive","Y"))})}function agCountryMaskBase(n,t,e,a){var o=window.intlTelInputGlobals.getInstance(t.get(0)),r={country:o.getSelectedCountryData().iso2};if((n.js.clear78||n.js.clear77)&&t.on("input",function(e){setTimeout(function(){var e;"ru"!=o.getSelectedCountryData().iso2||(e=t.val().replace(/[^+\d]/g,""))&&(n.js.clear78&&"+78"==e.slice(0,3)&&t.val(""),n.js.clear77&&"+77"==e.slice(0,3)&&t.val(""))},100)}),r.base_mask=t.attr("placeholder"),n.default.country_sng.includes(r.country)?r.work_mask=r.base_mask.replace(/_/g,"D"):r.work_mask=r.base_mask+"D{0,15}",r.work_mask=r.work_mask.replace(/9/g,"\\9"),r.work_default=r.work_mask,BX.onCustomEvent(r,"onCMaskEditMask",[r]),r.work_mask!=r.work_default&&t.attr("placeholder",r.work_mask.replace(/D/g,"_")),n.debug&&console.log("=> CMask base: work_mask = "+r.work_mask+";",t),a&&t.blur(),!e&&r.work_mask||t.inputmask("remove"),!e&&r.work_mask||t.val(""),!r.work_mask)return t.attr("placeholder",""),0;r={mask:r.work_mask,showMaskOnHover:!1,definitions:{D:{validator:"[0-9]",cardinality:1,definitionSymbol:"*"}}};(n.js.clear78||n.js.clear77)&&(r.onBeforePaste=function(e,t){e=e.replace(/\D/g,"");return n.js.clear78&&"8"==e.substr(0,1)&&"+7"==t.mask.substr(0,2)||n.js.clear77&&"7"==e.substr(0,1)&&"+7"==t.mask.substr(0,2)?"+7"+e.substr(1):"+"===t.mask.substr(0,1)&&"+"!==e.substr(0,1)&&t.mask.substr(1,2)==e.substr(0,2)?"+"+t.mask.substr(1,2)+e.substr(2):void 0},r.onKeyDown=function(e,t,a,o){var r=0;n.js.clear78&&8==e.key&&(r=1),n.js.clear77&&7==e.key&&(r=1);var s=window.intlTelInputGlobals.getInstance(e.currentTarget);r&&"+7"==o.mask.substr(0,2)&&"ru"==s.getSelectedCountryData().iso2&&(s=e.target.value.replace(/\D/g,""),o=o.mask.indexOf("9"),(""==s||a<=o)&&e.preventDefault())}),t.inputmask(r),a&&t.focus()}function agCountryMaskAsproOrderFix(){var e=0;if("object"==typeof arAsproOptions&&void 0!==arAsproOptions.PAGES&&arAsproOptions.PAGES.ORDER_PAGE&&(e=1),"object"==typeof arNextOptions&&arNextOptions.PAGES.ORDER_PAGE&&(e=1),"object"==typeof arOptimusOptions&&arOptimusOptions.PAGES.ORDER_PAGE&&(e=1),e&&$("#bx-soa-order input[autocomplete=tel]").length){for(var t,a,o=0;o<BX.Sale.OrderAjaxComponent.result.ORDER_PROP.properties.length;++o)"Y"==BX.Sale.OrderAjaxComponent.result.ORDER_PROP.properties[o].IS_PHONE&&(t=BX.Sale.OrderAjaxComponent.result.ORDER_PROP.properties[o]);void 0!==BX.Sale.OrderAjaxComponent&&"object"==typeof BX.Sale.OrderAjaxComponent&&"object"==typeof t&&t&&((a=$("input[autocomplete=tel][type=tel]")).on("blur",function(){var e=$(this),t=e.val();e.parent().parent().find("input[autocomplete=tel][type=text]").val(t)}),null!=(e=window.intlTelInputGlobals.getInstance(a.get(0)))&&(a.inputmask("getemptymask")||(e.destroy(),a.data("maskactive","N"))),BX.Sale.OrderAjaxComponent.bindValidationPhone(t.ID,$("input[autocomplete=tel]").parent()[0]))}}